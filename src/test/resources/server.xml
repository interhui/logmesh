<?xml version="1.0" encoding="UTF-8"?>
<server>

	<!--消息所有者-->
	<owner>Pinae</owner>
	
	<!-- 引入根配置文件 -->
	<import file="root.xml"/>
	
	<!-- 消息采集组件 -->
	<import file="receiver.xml"/>
	
	<!-- 消息输出组件 -->
	<import file="outputor.xml"/>
	
	<!--消息计数器配置-->
	<counter>
		<parameters>
			<!--是否激活消息计数器:true/false-->
			<parameter key="enable" value="true"/> 
			<!--消息计数器技术类型：时间计数(time)/所有者计数(owner)/IP(ip)/消息类型计数(type)，多个计数采用|分割-->
			<parameter key="counter" value="time|owner|ip|type"/> 
			 <!--计数周期 (s) -->
			<parameter key="cycle" value="60"/>
		</parameters>
	</counter>
	
	<!--原始消息记录器配置-->
	<original>
		<parameters>
			<!--是否激活原始日志存储:true/false-->
			<parameter key="enable" value="true"/> 
			<!--消息输出格式：时间(time)/所有者(owner)/IP(ip)/消息类型(type)/message(消息内容)-->
			<parameter key="msgFormat" value="$time : $ip : $message"/> 
			<!--消息存储路径-->
			<parameter key="path" value="d:\log\original"/>
			<!--消息文件目录格式-->
			<parameter key="dir" value="yyyy-MM-dd-HH-mm"/>
			<!--消息文件文件头-->
			<parameter key="title" value="message"/> 
			<!--消息文件格式（日期格式）-->
			<parameter key="pattern" value="yyyy-MM-dd-HH-mm"/>
			<!--消息文件扩展名-->
			<parameter key="ext" value="log"/>
			<!--消息文件编码-->
			<parameter key="encoding" value="utf8"/>
			<!--消息文件写入周期 (ms)-->
			<parameter key="cycle" value="5000"/> 
			<!--是否启用消息压缩，当启用消息压缩时，旧的压缩文件会被压缩为zip格式-->
			<parameter key="zip" value="true"/>
		</parameters>
	</original>
	
	<!--消息过滤器配置-->
	<!--
		目前包括的过滤器包括：
		 * IP过滤器 : org.pinae.logmesh.component.filter.impl.IPFilter
		 * 文本解码过滤器 : org.pinae.logmesh.component.filter.impl.TextDecodeFilter
		 * 关键字过滤器 : org.pinae.logmesh.component.filter.impl.KeywordFilter
		 * 正则表达式过滤器 : org.pinae.logmesh.component.filter.impl.RegexFilter
		 * 分类过滤器 : org.pinae.logmesh.component.filter.impl.ClassifyFilter
	-->
	<filter>
		<!--过滤器启动顺序-->
		<startup>1</startup>
		<!--过滤器名称-->
		<name>IPFilter</name>
		<!--是否启用该过滤器:true/false-->
		<enable>true</enable>
		<!--过滤器类-->
		<class>org.pinae.logmesh.component.filter.impl.IPFilter</class> 
		<parameters>
			<!--过滤配置文件-->
			<!-- <parameter key="file" value="filter/ip_filter.xml"/> -->
			<parameter key="filter" value="127.0.0.1"/>
			<parameter key="filter" value="127.0.0.1"/>
			<!--匹配拦截：false；匹配通过：true-->
			<parameter key="pass" value="true"/>
		</parameters>
	</filter>
	<filter>
		<startup>2</startup>
		<name>TextDecodeFilter</name>
		<enable>true</enable>
		<class>org.pinae.logmesh.component.filter.impl.TextDecodeFilter</class>
		<parameters>
			<parameter key="file" value="filter/text_decode_filter.xml"/>
		</parameters>
	</filter>
	<filter>
		<startup>3</startup>
		<name>KeywordFilter</name>
		<enable>true</enable>
		<class>org.pinae.logmesh.component.filter.impl.KeywordFilter</class>
		<parameters>
			<parameter key="file" value="filter/keyword_filter.xml"/>
			<parameter key="pass" value="true"/>
		</parameters>
	</filter>
	<filter>
		<startup>4</startup>
		<name>RegexFilter</name>
		<enable>true</enable>
		<class>org.pinae.logmesh.component.filter.impl.RegexFilter</class>
		<parameters>
			<parameter key="file" value="filter/regex_filter.xml"/>
			<parameter key="pass" value="true"/>
		</parameters>
	</filter>
	<filter>
		<startup>5</startup>
		<name>ClassifyFilter</name>
		<enable>true</enable>
		<class>org.pinae.logmesh.component.filter.impl.ClassifyFilter</class>
		<parameters>
			<parameter key="file" value="filter/classify_filter.xml"/>
		</parameters>
	</filter>
	
	<!--消息路由配置-->
	<!--目前包括的路由器包括：IP路由器/正则路由器-->
	<router>
		<!--路由器名称-->
		<name>IPRoute</name>
		<!--是否启用该路由器:true/false-->
		<enable>true</enable>
		<!--路由器类-->
		<class>org.pinae.logmesh.component.router.impl.IPRouter</class>
		<parameters>
			<!--路由配置文件-->
			<parameter key="file" value="router/ip_router.xml"/>
		</parameters>
	</router>
	<router>
		<!--路由器名称-->
		<name>RegexRoute</name>
		<!--是否启用该路由器:true/false-->
		<enable>true</enable>
		<!--路由器类-->
		<class>org.pinae.logmesh.component.router.impl.RegexRouter</class>
		<parameters>
			<!--路由配置文件-->
			<parameter key="file" value="router/regex_router.xml"/>
		</parameters>
	</router>
	
	<!--自定义消息处理配置-->
	<processor>
		<!--处理器名称-->
		<name>DemoCustomProcessor</name>
		<!--是否启动处理器:true/false-->
		<enable>true</enable>
		<!--处理器类-->
		<class>org.pinae.logmesh.component.custom.DemoCustomProcessor</class>
		<!--处理器参数，由处理器自行决定-->
		<parameters>
			<parameter key="title" value="message"/>
		</parameters>
	</processor>

</server>